var vpsc;(function(n){function s(n){return n.bounds=n.leaves.reduce(function(n,t){return t.bounds.union(n)},t.empty()),typeof n.groups!="undefined"&&(n.bounds=n.groups.reduce(function(n,t){return s(t).union(n)},n.bounds)),n.bounds}function c(n,t){return n.pos>t.pos?1:n.pos<t.pos?-1:n.isOpen?-1:0}function r(){return new RBTree(function(n,t){return n.pos-t.pos})}function e(n,t,i,r){typeof r=="undefined"&&(r=!1);var c=typeof n.padding=="undefined"?1:n.padding,s=[],h=typeof n.groups!="undefined"?n.groups.length:0,l=typeof n.leaves!="undefined"?n.leaves.length:0;h&&n.groups.forEach(function(n){s=s.concat(e(n,t,i,!0))});var a=t.getCentre(n.bounds),v=t.getSize(n.bounds)/2,y=(r?2:0)+l+h*2,u=new Array(y),f=[];return r&&(f.push(n.minRect=t.makeRect(t.getOpen(n.bounds),t.getClose(n.bounds),a-v,c)),n.minVar.desiredPosition=t.getCentre(n.minRect),u.push(n.minVar),f.push(n.maxRect=t.makeRect(t.getOpen(n.bounds),t.getClose(n.bounds),a+v,c)),n.minVar.desiredPosition=t.getCentre(n.maxRect),u.push(n.maxVar)),l&&n.leaves.forEach(function(n){f.push(n.bounds),u.push(n.variable)}),h&&n.groups.forEach(function(n){f.push(n.minRect),u.push(n.minVar),f.push(n.maxRect),u.push(n.maxVar)}),s.concat(o(f,u,t,i))}function o(t,u,f,e){var o,y=t.length,d=2*y,l,a,p,v,w,s,b,k;for(console.assert(u.length>=y),l=new Array(d),o=0;o<y;++o)a=t[o],s=new h(u[o],a,f.getCentre(a)),l[o]=new i(!0,s,f.getOpen(a)),l[o+y]=new i(!1,s,f.getClose(a));for(l.sort(c),p=[],v=r(),o=0;o<d;++o)w=l[o],s=w.v,w.isOpen?(v.insert(s),f.findNeighbours(s,v)):(v.remove(s),b=function(t,i){var r=(f.getSize(t.r)+f.getSize(i.r))/2+e;p.push(new n.Constraint(t.v,i.v,r))},k=function(n,t,i){for(var r,u=s[n].iterator();(r=u[n]())!==null;)i(r,s),r[t].remove(s)},k("prev","next",function(n,t){return b(n,t)}),k("next","prev",function(n,t){return b(t,n)}));return console.assert(v.size===0),p}function l(n,t){var i=function(i,r){for(var e=t.findIter(n),u,f;(u=e[i]())!==null;)if(f=u.r.overlapX(n.r),(f<=0||f<=u.r.overlapY(n.r))&&(n[i].insert(u),u[r].insert(n)),f<=0)break};i("next","prev"),i("prev","next")}function a(n,t){var i=function(i,r){var u=t.findIter(n)[i]();u!==null&&u.r.overlapX(n.r)>0&&(n[i].insert(u),u[r].insert(n))};i("next","prev"),i("prev","next")}function v(n,t){return o(n,t,u,1e-6)}function y(n,t){return o(n,t,f,1e-6)}function p(n){return e(n,u,1e-6)}function w(n){return e(n,f,1e-6)}function b(t){var i=t.map(function(t){return new n.Variable(t.cx())}),r=n.generateXConstraints(t,i),u=new n.Solver(i,r);u.solve(),i.forEach(function(n,i){return t[i].setXCentre(n.position())}),i=t.map(function(t){return new n.Variable(t.cy())}),r=n.generateYConstraints(t,i),u=new n.Solver(i,r),u.solve(),i.forEach(function(n,i){return t[i].setYCentre(n.position())})}var t,h,i,u,f;n.computeGroupBounds=s,t=function(){function n(n,t,i,r){this.x=n,this.X=t,this.y=i,this.Y=r}return n.empty=function(){return new n(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},n.prototype.cx=function(){return(this.x+this.X)/2},n.prototype.cy=function(){return(this.y+this.Y)/2},n.prototype.overlapX=function(n){var t=this.cx(),i=n.cx();return t<=i&&n.x<this.X?this.X-n.x:i<=t&&this.x<n.X?n.X-this.x:0},n.prototype.overlapY=function(n){var t=this.cy(),i=n.cy();return t<=i&&n.y<this.Y?this.Y-n.y:i<=t&&this.y<n.Y?n.Y-this.y:0},n.prototype.setXCentre=function(n){var t=n-this.cx();this.x+=t,this.X+=t},n.prototype.setYCentre=function(n){var t=n-this.cy();this.y+=t,this.Y+=t},n.prototype.width=function(){return this.X-this.x},n.prototype.height=function(){return this.Y-this.y},n.prototype.union=function(t){return new n(Math.min(this.x,t.x),Math.max(this.X,t.X),Math.min(this.y,t.y),Math.max(this.Y,t.Y))},n}(),n.Rectangle=t,h=function(){function n(n,t,i){this.v=n,this.r=t,this.pos=i,this.prev=r(),this.next=r()}return n}(),i=function(){function n(n,t,i){this.isOpen=n,this.v=t,this.pos=i}return n}(),u={getCentre:function(n){return n.cx()},getOpen:function(n){return n.y},getClose:function(n){return n.Y},getSize:function(n){return n.width()},makeRect:function(n,i,r,u){return new t(r-u/2,r+u/2,n,i)},findNeighbours:l},f={getCentre:function(n){return n.cy()},getOpen:function(n){return n.x},getClose:function(n){return n.X},getSize:function(n){return n.height()},makeRect:function(n,i,r,u){return new t(n,i,r-u/2,r+u/2)},findNeighbours:a},n.generateXConstraints=v,n.generateYConstraints=y,n.generateXGroupConstraints=p,n.generateYGroupConstraints=w,n.removeOverlaps=b})(vpsc||(vpsc={}));
//# sourceMappingURL=rectangle.min.js.map